# Git-secrets patterns for Ephemos
# This file defines patterns for sensitive data detection

# AWS Access Keys
[A-Z0-9]{20}

# AWS Secret Keys  
[A-Za-z0-9/+=]{40}

# Generic API Keys
[aA][pP][iI][_-]?[kK][eE][yY].*[0-9a-zA-Z]{16,}

# Generic Secrets
[sS][eE][cC][rR][eE][tT].*[0-9a-zA-Z]{16,}

# Generic Tokens
[tT][oO][kK][eE][nN].*[0-9a-zA-Z]{16,}

# Generic Passwords (only if they look like real passwords)
[pP][aA][sS][sS][wW][oO][rR][dD].*[0-9a-zA-Z!@#$%^&*]{12,}

# Private Keys (PEM format)
-----BEGIN[ A-Z]*PRIVATE KEY-----

# JWT Tokens
eyJ[A-Za-z0-9_/+-]*={0,2}\.eyJ[A-Za-z0-9_/+-]*={0,2}\.[A-Za-z0-9_/+-]*={0,2}

# SPIFFE Production URIs (not example.org)
spiffe://[a-zA-Z0-9.-]+\.(com|net|org|io)/[a-zA-Z0-9_/-]+

# Database Connection Strings
(postgresql|mysql|mongodb)://[^/\s]+:[^@\s]+@

# GitHub Tokens
ghp_[0-9a-zA-Z]{36}
gho_[0-9a-zA-Z]{36}
ghu_[0-9a-zA-Z]{36}
ghs_[0-9a-zA-Z]{36}
ghr_[0-9a-zA-Z]{36}

# Docker Hub Tokens
dckr_pat_[0-9a-zA-Z_-]{36}

# Kubernetes Service Account Tokens
eyJhbGciOiJSUzI1NiIs[A-Za-z0-9_/+-]*={0,2}

# Base64 Encoded Secrets (longer than 20 chars, not template placeholders)
(?<!<BASE64_ENCODED_)[A-Za-z0-9+/]{20,}={0,2}(?!>)

# Real domains in configuration (not example domains)
(?<!example\.)(?<!test\.)[a-zA-Z0-9-]+\.(com|net|org|io)(?!\s*#.*example)

# IP Addresses that might be production
(?<!127\.0\.0\.)(?<!192\.168\.)(?<!10\.)[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}

# Production socket paths
/run/spire/sockets/[a-zA-Z0-9.-]+\.sock

# Exclude patterns (these are allowed)
# example.org domains
# test.local domains  
# localhost addresses
# Template placeholders like <PLACEHOLDER>
# Demo service names